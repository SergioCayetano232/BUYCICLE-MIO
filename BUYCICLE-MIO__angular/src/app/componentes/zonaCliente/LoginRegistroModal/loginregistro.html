<!-- Modal -->
<div class="modal fade" id="modalLoginRegistro" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="modalLoginRegistroLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">

      <div class="modal-body">
        <div class="container">

          <div class="row">
            <div class="col  d-flex flex-row justify-content-between align-items-center">
              <h1 class="modal-title fs-5" id="modalLoginRegistroLabel">
                  {{ typeModal()  ? 'Iniciar Sesión en buycycle' : 'Crear una cuenta' }}
              </h1>
              <button #btnClose type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
          </div>

          <div class="row">
            <div class="col">
              @if(typeModal() ) {
                <p>El mercado mundial de bicis de segunda mano</p>
              }@else {
                <div class="d-flex flex-row justify-content-between">
                  <button type="button" class="btn btn-dark w-50 mb-2 d-flex align-items-center border">Usuario particular</button>      
                  <button type="button" class="btn btn-secondary w-50 mb-2 d-flex align-items-center border">Vendedor comercial</button>      
                </div>
              }
            </div>
          </div>

          <div class="row">
            <div class="col d-flex flex-row align-items-center">
                  <button type="button" class="btn w-50 mb-2 d-flex align-items-center border" style="background-color: #fff; border-color: #dadce0;">
                    <img src="https://developers.google.com/identity/images/g-logo.png" alt="Google" width="20" height="20" class="me-2"/>
                      <span class="flex-grow-1 text-center">
                        Gmail
                      </span>
                  </button>      
                  <button type="button" class="btn w-50 mb-2 d-flex align-items-center border" style="background-color: #fff; border-color: #dadce0;">
                    <i class="fa-brands fa-apple"></i>
                    <span class="flex-grow-1 text-center">
                      Apple
                    </span>
                  </button>
           
            </div>
          </div>

          <div class="row">
            <div class="col d-flex flex-row justify-content-center align-items-center">
              <div  style="box-sizing: border-box; border: 0.5px solid #dadce0; width: 100%;"></div>
              <p class="px-5 text-contentPrimary text-sm font-regular text-nowrap ">o con</p>
              <div style="box-sizing: border-box; border: 0.5px solid #dadce0; width: 100%;"></div>         
            </div>
          </div>

          <!-- formulario login o registro -->
          <div class="row">
            <div class="col d-flex flex-column p-2" >
              <form [formGroup]="miform">
                <!-- div para mostrar mensajes de error de nuestro servicio, google, etc .... -->
                <div class="text-danger" #divErrores></div>

                @if(!typeModal()) {
                    <div class="mb-3">
                      <label for="inputNombre" class="form-label">Nombre</label>
                      <input type="text" class="form-control" id="inputNombre" placeholder="Nombre" formControlName="nombre">
                      @if(miform.get('nombre')?.dirty && miform.get('nombre')?.invalid){
                        <div class="d-flex flex-column justify-content-start">
                          @if( miform.get('nombre')?.errors?.['required'] ) { <span class="text-danger">*El nombre es obligatorio.</span> }
                          @if( miform.get('nombre')?.errors?.['minlength'] ) { <span class="text-danger">*El nombre debe tener al menos 2 caracteres.</span> }
                          @if( miform.get('nombre')?.errors?.['maxlength'] ) { <span class="text-danger">*El nombre no puede exceder los 50 caracteres.</span> }
                        </div>
                      }
                    </div>
                    <div class="mb-3">
                      <label for="inputApellido" class="form-label">Apellido</label>
                      <input type="text" class="form-control" id="inputApellido" placeholder="Apellido" formControlName="apellidos">
                      @if(miform.get('apellidos')?.dirty && miform.get('apellidos')?.invalid){
                        <div class="d-flex flex-column justify-content-start">
                          @if( miform.get('apellidos')?.errors?.['required'] ) { <span class="text-danger">*El apellido es obligatorio.</span> }
                          @if( miform.get('apellidos')?.errors?.['minlength'] ) { <span class="text-danger">*El apellido debe tener al menos 2 caracteres.</span> }
                          @if( miform.get('apellidos')?.errors?.['maxlength'] ) { <span class="text-danger">*El apellido no puede exceder los 100 caracteres.</span> }
                        </div>
                      }
                    </div>
                }
                
                <div class="mb-3">
                  <label for="inputEmailRegistro" class="form-label">Correo electrónico</label>
                  <input type="email" class="form-control" id="inputEmailRegistro" placeholder="Tu correo electrónico" formControlName="email">
                  @if(miform.get('email')?.dirty && miform.get('email')?.invalid){
                    <div class="d-flex flex-column justify-content-start">
                      @if( miform.get('email')?.errors?.['required'] ) { <span class="text-danger">*El correo electrónico es obligatorio.</span> }
                      @if( miform.get('email')?.errors?.['email'] ) { <span class="text-danger">*El correo electrónico no es válido.</span> }
                    </div>
                  }
                </div>
                
                @if(!typeModal()) {
                    <div class="mb-3">
                      <label for="inputTelefono" class="form-label">Número de Teléfono</label>
                      <input type="tel" class="form-control" id="inputTelefono" placeholder="+34666112233" formControlName="telefono">
                      @if(miform.get('telefono')?.dirty && miform.get('telefono')?.invalid){
                        <div class="d-flex flex-column justify-content-start">
                          @if( miform.get('telefono')?.errors?.['required'] ) { <span class="text-danger">*El teléfono es obligatorio.</span> }
                          @if( miform.get('telefono')?.errors?.['pattern'] ) { <span class="text-danger">*El teléfono no tiene formato adecuado para un movil.</span> }
                        </div>
                      }
                    </div>
                } 
                
                <div class="mb-3">
                  <label for="inputPassword" class="form-label">Contraseña</label>
                  <input type="password" class="form-control" id="inputPassword" placeholder="Contraseña" formControlName="password">
                  @if(miform.get('password')?.dirty && miform.get('password')?.invalid){
                    <div class="d-flex flex-column justify-content-start">
                      @if( miform.get('password')?.errors?.['required'] ) { <span class="text-danger">*La contraseña es obligatoria.</span> }
                      @if( miform.get('password')?.errors?.['minlength'] ) { <span class="text-danger">*La contraseña debe tener al menos 6 caracteres.</span> }
                      @if( miform.get('password')?.errors?.['pattern'] ) { <span class="text-danger">*La contraseña no cumple con el formato requerido: 1 mays, 1m mins, 1 número y 1 caracter especial.</span> }
                    </div>
                  }
                </div>

                @if(!typeModal()) {
                  <div class="mb-3">
                    <label for="inputPasswordRegistro" class="form-label">Confirmar Contraseña</label>
                    <input type="password" class="form-control" id="inputPasswordRegistro" placeholder="Confirmar contraseña" formControlName="confirmPassword">
                    @if(miform.get('confirmPassword')?.dirty && miform.get('confirmPassword')?.invalid){
                      <div class="d-flex flex-column justify-content-start">
                        @if( miform.get('confirmPassword')?.errors?.['required']) { <span class="text-danger">*La confirmación de la contraseña es obligatoria.</span> }
                        @if( miform.get('confirmPassword')?.errors?.['minlength']) { <span class="text-danger">*La confirmación de la contraseña debe tener al menos 6 caracteres.</span> }
                        @if( miform.get('confirmPassword')?.errors?.['pattern']) { <span class="text-danger">*La confirmación de la contraseña no cumple con el formato requerido: 1 mays, 1m mins, 1 número y 1 caracter especial.</span> }
                        @if( miform.get('confirmPassword')?.errors?.['comparePasswords']) { <span class="text-danger">*Las contraseñas no coinciden.</span> }
                      </div>
                    }                    
                  </div>
                }

                <div class="mb-3 form-check">
                  <input type="checkbox" class="form-check-input" id="checkRememberMe">
                  <label class="form-check-label" for="checkRememberMe">{{ typeModal() ? 'Recuérdame' : 'Acepto los Terminos y la Política de Privacidad' }}</label>
                </div>
              </form>
            </div>
          </div>

          <!-- botones cambiar entre login y registro -->
          <div class="row">
            <div class="col d-flex flex-column justify-content-center align-items-center m-2">
              <button type="button" [disabled]="!miform.valid" (click)="SubmitForm()" class="btn btn-dark w-100">{{ typeModal() ? 'Iniciar sesión' : 'Registrate en buycycle' }}</button>
              @if(typeModal()){ <span class="m-2" style="font-weight: 800; font-size: 1rem;">¿Nuevo en buycycle?</span> }
              <button type="button"  [ngClass]="{ 'mt-4': !typeModal(), 'btn btn-outline-secondary w-100': true }" (click)="typeModal.set(!typeModal())">{{ typeModal() ? 'Crear cuenta' : 'Volver a iniciar sesión' }}</button>
            </div>
          </div>          

        </div>
      </div>

    </div>
  </div>
</div>
